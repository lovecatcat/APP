<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<link href="css/mui.css" rel="stylesheet" />
		<link href="css/common.css" rel="stylesheet" />
		<link href="css/module.css" rel="stylesheet" />
		<link href="css/news.css" rel="stylesheet" />
		<script src="js/config.js" type="text/javascript"></script>
	</head>

	<body class="BL-bg-fff">

		<!------------资讯列表 begin------------->
		<div id="Js-newsList" class="news-list">
			<div id="Js-list" class="mui-content mui-scroll-wrapper">
				<div class="mui-scroll">
					<!--活动中，数据列表-->
					<ul class="mui-table-view news-list-cell">
						<li class="nItem">
							<a data-id="111" data-wid="news_detail" href="news-detail.html" class="BL-ub BL-ub-f1">
								<div class="img">
									<img src="images/pic/p7.jpg" />
								</div>
								<div class="context BL-ub BL-ub-ver BL-ub-f1">
									<h1 class="tit"><span class="tit-badg tit-badg-hot">热门</span>惠州龙门大观园温泉，鲁冰花童话园2日游</h1>
									<div class="name">行业资讯</div>
								</div>
							</a>
						</li>
						<li class="nItem">
							<a data-id="2" data-wid="news_tv_detail" href="news-tv-detail.html" class="BL-ub BL-ub-f1">
								<div class="img">
									<img src="images/pic/p7.jpg" />
								</div>
								<div class="context BL-ub BL-ub-ver BL-ub-f1">
									<h1 class="tit"><span class="tit-badg tit-badg-tv">视频</span>最补血的居然不是红枣！真正的“补血之王”原来是它</h1>
									<div class="name">公司VCR</div>
								</div>
							</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!------------资讯列表 end  ------------->

	</body>
	<script src="js/mui.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		mui.init({
			pullRefresh: {
				container: '#Js-list', //待刷新区域标识，querySelector能定位的css选择器均可，比如：id、.class等
				down: {},
				up: {
					height: 50, //可选.默认50.触发上拉加载拖动距离
					auto: false, //可选,默认false.自动上拉加载一次
					contentrefresh: "正在加载...", //可选，正在加载状态时，上拉加载控件上显示的标题内容
					contentnomore: '已全部加载完', //可选，请求完毕若没有更多数据时显示的提醒内容；
					callback: pullupRefresh //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
				}
			}
		});
		
		/**
		 * 下拉刷新具体业务实现
		 */
		function pulldownRefresh() {
			setTimeout(function() {
				var table = document.body.querySelector('.news-list-cell');
				var cells = document.body.querySelectorAll('.nItem');
				for(var i = cells.length, len = i + 3; i < len; i++) {
					var li = document.createElement('li');
					li.className = 'nItem';
					li.innerHTML = '<a data-wid="news_detail" href="news-detail.html" class="BL-ub BL-ub-f1">' +
						'<div class="img"><img src="images/pic/p7.jpg" /></div>' +
						'<div class="context BL-ub BL-ub-ver BL-ub-f1"><h1 class="tit">惠州龙门大观园温泉，鲁冰花童话园2日游</h1>' +
						'<div class="name">行业资讯</div></div></a>';
					//下拉刷新，新纪录插到最前面；
					table.insertBefore(li, table.firstChild);
				}
				mui('#Js-list').pullRefresh().endPulldownToRefresh(); //refresh completed
			}, 1);
		}
		var count = 0;
		/**
		 * 上拉加载具体业务实现
		 */
		function pullupRefresh() {
			setTimeout(function() {
				mui('#Js-list').pullRefresh().endPullupToRefresh((++count > 0)); //参数为true代表没有更多数据了。
				var table = document.body.querySelector('.news-list-cell');
				var cells = document.body.querySelectorAll('.nItem');
				for(var i = cells.length, len = i + 5; i < len; i++) {
					var li = document.createElement('li');
					li.className = 'nItem';
					li.innerHTML = '<a data-wid="news_detail" href="news-detail.html" class="BL-ub BL-ub-f1">' +
						'<div class="img"><img src="images/pic/p7.jpg" /></div>' +
						'<div class="context BL-ub BL-ub-ver BL-ub-f1"><h1 class="tit">惠州龙门大观园温泉，鲁冰花童话园2日游</h1>' +
						'<div class="name">行业资讯</div></div></a>';
					table.appendChild(li);
				}
			}, 500);
		}

		var detailPage = null;
		var winH = window.innerHeight;
		document.querySelector('#Js-newsList').style.height = winH + 'px';

		//主列表点击事件
		mui('body').on('tap', 'a', function() {
			var href = this.getAttribute('href');
			var id = this.getAttribute("data-wid");
			var pid = this.getAttribute('data-id');

			//非plus环境，直接走href跳转
			if(!mui.os.plus) {
				location.href = href;
				return;
			};

			if(href && ~href.indexOf('.html')) {

				if(pid) {
					//获得详情页面
					if(!detailPage) {
						detailPage = plus.webview.getWebviewById(id);
					}
					//触发详情页面的newsId事件
					mui.fire(detailPage, 'newsId', {
						id: pid
					});
				};

				//打开新窗口
				mui.openWindow({
					id:id,
					show:animateObj.aniDetal
				});
			}

		});

		mui.plusReady(function() {
				
		})
	</script>

</html>