<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<link href="css/mui.css" rel="stylesheet" />
		<link href="css/common.css" rel="stylesheet" />
		<link href="css/module.css" rel="stylesheet" />
		<link href="css/product.css" rel="stylesheet" />
		<script src="js/config.js" type="text/javascript"></script>
	</head>

	<body class="BL-bg-f2f">
		<header id="Js-header" class="BL-bg-fff">
			<div class="BL-mod-headbar">
				<div class="BL-ub BL-ub-ac headbar-search">
					<a class="mui-action-back mui-icon-left-nav BL-icon BL-icon-left"></a>
					<div class="search search-pro BL-ub BL-ub-ac BL-ub-f1">
						<input type="search" name="Js-search" id="Js-search" value="搜索关键词" class="BL-ub BL-ub-f1" />
						<div class="button">
							<span class="BL-bimg-contain">&nbsp;</span>
						</div>
					</div>
				</div>
			</div>
		</header>

		<div id="Js-content" class="mui-content product">
			<!------------条件筛选 begin------------->
			<div id="Js-productFilter" class="product-filter">

				<!--分类栏目 begin-->
				<div class="mui-scroll-wrapper mui-slider-indicator mui-segmented-control mui-segmented-control-inverted BL-segmented-control">
					<div class="mui-scroll">
						<a class="mui-control-item mui-active">
							全部
						</a>
						<a class="mui-control-item">
							医疗
						</a>
						<a class="mui-control-item">
							重疾
						</a>
						<a class="mui-control-item">
							意外
						</a>
						<a class="mui-control-item">
							航旅
						</a>
					</div>
				</div>
				<!--分类栏目 end -->

				<!--状态筛选 begin-->
				<div class="filter-state">
					<div class="BL-ub BL-ub-ac state-select">
						<div class="mui-col-sm-4 mui-col-xs-4 item mui-active item-active-up">
							<div class="BL-ub BL-ub-ac BL-ub-pc">
								<div class="text">
									价格排序
								</div>
								<div class="BL-ub BL-ub-ver">
									<a class="item-control item-control-up"></a>
									<a class="item-control item-control-down"></a>
								</div>
							</div>
						</div>
						<div class="mui-col-sm-4 mui-col-xs-4 item">
							销量排序
						</div>
						<div class="mui-col-sm-4 mui-col-xs-4 item mui-active">
							<div class="BL-ub BL-ub-ac BL-ub-pc">
								<div class="text">
									筛选
								</div>
								<div class="BL-ub BL-ub-ver">
									<a class="item-control item-control-filter"></a>
								</div>
							</div>
						</div>
					</div>
					<!--<div class="BL-ub BL-ub-ac state-menus">
						<div class="menu">
							新品	
						</div>	
						<div class="menu">
							热卖	
						</div>	
					</div>-->
				</div>
				<!--状态筛选 end -->

			</div>
			<!------------条件筛选 end  ------------->

			<!------------产品列表 begin------------->
			<div id="Js-productList" class="product-list">
				<div id="Js-list" class="mui-content mui-scroll-wrapper BL-bg-f2f">
					<div class="mui-scroll">
						<!--活动中，数据列表-->
						<ul class="mui-table-view product-list-cell">
							<li class="cItem">
								<a data-id="2" data-wid="product_detail" href="product-detail.html" class="BL-ub BL-ub-f1 pro-icon-new">
									<div class="img">
										<img src="images/pic/p6.jpg" />
									</div>
									<div class="context BL-ub BL-ub-ver BL-ub-f1">
										<h1 class="tit">横琴优爱宝定期寿险</h1>
										<div class="text">月12日11时，中央纪委发布消息，“河北省人大常委会副主任张杰辉涉嫌严重违纪</div>
										<div class="price">
											168元起
										</div>
									</div>
								</a>
							</li>
							<li class="cItem">
								<a data-wid="product_detail" href="product-detail.html" class="BL-ub BL-ub-f1 pro-icon-hot">
									<div class="img">
										<img src="images/pic/p6.jpg" />
									</div>
									<div class="context BL-ub BL-ub-ver BL-ub-f1">
										<h1 class="tit">横琴优爱宝定期寿险</h1>
										<div class="text">月12日11时，中央纪委发布消息，“河北省人大常委会副主任张杰辉涉嫌严重违纪</div>
										<div class="price">
											168元起
										</div>
									</div>
								</a>
							</li>
							<li class="cItem">
								<a data-wid="product_detail" href="product-detail.html" class="BL-ub BL-ub-f1">
									<div class="img">
										<img src="images/pic/p6.jpg" />
									</div>
									<div class="context BL-ub BL-ub-ver BL-ub-f1">
										<h1 class="tit">横琴优爱宝定期寿险</h1>
										<div class="text">月12日11时，中央纪委发布消息，“河北省人大常委会副主任张杰辉涉嫌严重违纪</div>
										<div class="price">
											168元起
										</div>
									</div>
								</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<!------------产品列表 end  ------------->
		</div>

		<!------------悬浮控制按钮 begin-------------->
		<div class="popuer">
			<a data-wid="" href="javascript:;" class="popu-IconMenu"><img src="images/product/menu-prospect.png" alt="计划书" /></a>
			<a data-wid="product_contrast_detail" href="product-contrast-detail.html" class="popu-IconMenu"><img src="images/product/menu-pk.png" alt="产品对比" /></a>
		</div>
		<!------------悬浮控制按钮 end --------------->
	</body>
	<script src="js/mui.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		mui.init({
			pullRefresh: {
				container: '#Js-list', //待刷新区域标识，querySelector能定位的css选择器均可，比如：id、.class等
				down: {},
				up: {
					height: 50, //可选.默认50.触发上拉加载拖动距离
					auto: false, //可选,默认false.自动上拉加载一次
					contentrefresh: "正在加载...", //可选，正在加载状态时，上拉加载控件上显示的标题内容
					contentnomore: '已全部加载完', //可选，请求完毕若没有更多数据时显示的提醒内容；
					callback: pullupRefresh //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
				}
			},
			preloadPages: [
				{ // 预加载详情页
					url: 'product-detail.html',
					id: 'product_detail'
				},
				{ // 预加载PK对比页
					url: 'product-contrast-detail.html',
					id: 'product_contrast_detail'
				}
			]
		});
		
		statusbar();
		
		/**
		 * 下拉刷新具体业务实现
		 */
		function pulldownRefresh() {
			setTimeout(function() {
				var table = document.body.querySelector('.product-list-cell');
				var cells = document.body.querySelectorAll('.cItem');
				for(var i = cells.length, len = i + 3; i < len; i++) {
					var li = document.createElement('li');
					li.className = 'mui-table-view-cell';
					li.innerHTML = '<a class="mui-navigate-right">Item ' + (i + 1) + '</a>';
					//下拉刷新，新纪录插到最前面；
					table.insertBefore(li, table.firstChild);
				}
				mui('#Js-list').pullRefresh().endPulldownToRefresh(); //refresh completed
			}, 1);
		}
		var count = 0;
		/**
		 * 上拉加载具体业务实现
		 */
		function pullupRefresh() {
			setTimeout(function() {
				mui('#Js-list').pullRefresh().endPullupToRefresh((++count > 0)); //参数为true代表没有更多数据了。
				var table = document.body.querySelector('.product-list-cell');
				var cells = document.body.querySelectorAll('.cItem');
				for(var i = cells.length, len = i + 5; i < len; i++) {
					var li = document.createElement('li');
					li.className = 'cItem';
					li.innerHTML = '<a data-wid="product_detail" href="products-detail.html" class="BL-ub BL-ub-f1">' +
						'<div class="img"><img src="images/pic/p6.jpg" /></div>' +
						'<div class="context BL-ub BL-ub-ver BL-ub-f1"><h1 class="tit">横琴优爱宝定期寿险</h1>' +
						'<div class="text">月12日11时，中央纪委发布消息，“河北省人大常委会副主任张杰辉涉嫌严重违纪</div>' +
						'<div class="price">168元起</div></div></a>';
					table.appendChild(li);
				}
			}, 500);
		}

		var detailPage = null;
		var winH = window.innerHeight;
		var titHeight = document.querySelector('#Js-header').offsetHeight;
		var divHeight = document.querySelector('#Js-productFilter').offsetHeight;
		document.querySelector('#Js-productList').style.height = winH - titHeight - divHeight + 'px';

		//主列表点击事件
		mui('body').on('tap', 'a', function() {
			var href = this.getAttribute('href');
			var id = this.getAttribute("data-wid");
			var pid = this.getAttribute('data-id');

			//非plus环境，直接走href跳转
			if(!mui.os.plus) {
				location.href = href;
				return;
			};

			if(href && ~href.indexOf('.html')) {
				
				if(pid){
					//获得详情页面
					if(!detailPage) {
						detailPage = plus.webview.getWebviewById(id);
					}
					//触发详情页面的productId事件
					mui.fire(detailPage, 'productId', {
						id: pid
					});
				};
				
				//打开新窗口
				mui.openWindow({
					id:id,
					show:animateObj.aniDetal
				});
			}

		});

		mui.plusReady(function() {
			
		})
	</script>

</html>