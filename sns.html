<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>SNS活动</title>
		<link href="css/mui.css" rel="stylesheet" />
		<link href="css/common.css" rel="stylesheet" />
		<link href="css/module.css" rel="stylesheet" />
		<link href="css/sns.css" rel="stylesheet" />
		<script src="js/config.js" type="text/javascript"></script>
	</head>

	<body class="BL-bg-f2f">
		<header id="Js-header" class="BL-bg-fff">
			<div class="BL-mod-headbar BL-mod-headbar-pos">
				<a class="mui-action-back mui-icon-left-nav BL-icon BL-icon-left"></a>
				<h1 class="BL-title">SNS活动</h1>
			</div>
		</header>

		<div id="slider" class="mui-slider">

			<div id="Js-content" class="BL-pad-t-1">
				<div id="sliderSegmentedControl" class="mui-slider-indicator mui-segmented-control mui-segmented-control-inverted BL-segmented-control">
					<a class="mui-control-item" href="#item1">活动中</a>
					<a class="mui-control-item" href="#item2">活动回顾</a>
				</div>
			</div>
			<div id="sliderProgressBar" class="mui-slider-progress-bar mui-col-xs-6"></div>

			<div class="mui-slider-group">

				<!--第一个内容区容器-->
				<div id="item1" class="mui-slider-item mui-control-content mui-active">
					<div id="Js-list" class="mui-content mui-scroll-wrapper sns-acting BL-bg-f2f">
						<div class="mui-scroll">
							<!--活动中，数据列表-->
							<ul class="mui-table-view sns-acting-cell">
								<li class="cItem">
									<a data-wid="sns_detail" href="sns-detail.html" class="BL-ub BL-ub-f1">
										<div class="img">
											<img src="images/pic/p3.jpg" />
										</div>
										<div class="context BL-ub BL-ub-ver BL-ub-f1">
											<h1 class="tit">惠州龙门大观园温泉，鲁冰花童话园2日游</h1>
											<div class="date">
												<span class="tit-name">时间 :</span>
												<span class="tit-text">2017-11-12</span>
											</div>
											<div class="place">
												<span class="tit-name">地点 :</span>
												<span class="tit-text">广东省广州市经济技术开发区永顺大道西126号</span>
											</div>
											<div class="state">
												<span id="Js-isOver" class="tit-name">已结束</span>
												<span class="tit-text">
															<b>40</b>人已报名
														</span>
											</div>
										</div>
									</a>
								</li>
							</ul>
						</div>
					</div>
				</div>

				<!--第二个内容区-->
				<div id="item2" class="mui-slider-item mui-control-content">
					2
				</div>

			</div>
		</div>

	</body>
	<script src="js/mui.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		statusbar();
		var winH = window.innerHeight;
		var topHeight = document.getElementById('Js-header').offsetHeight;
		var mainHeight = document.getElementById('Js-content').offsetHeight;
		document.querySelector('.mui-slider-group').style.height = winH - topHeight - mainHeight + 'px';

		document.querySelector('#slider').addEventListener('slide', function(evt) {
			console.log(evt.detail.slideNumber)

		});

		mui.init({
			pullRefresh: {
				container: '#Js-list', //待刷新区域标识，querySelector能定位的css选择器均可，比如：id、.class等
				down: {},
				up: {
					height: 50, //可选.默认50.触发上拉加载拖动距离
					auto: false, //可选,默认false.自动上拉加载一次
					contentrefresh: "正在加载...", //可选，正在加载状态时，上拉加载控件上显示的标题内容
					contentnomore: '已全部加载完', //可选，请求完毕若没有更多数据时显示的提醒内容；
					callback: pullupRefresh //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
				}
			}
		});

		/**
		 * 下拉刷新具体业务实现
		 */
		function pulldownRefresh() {
			setTimeout(function() {
				var table = document.body.querySelector('.sns-acting-cell');
				var cells = document.body.querySelectorAll('.cItem');
				for(var i = cells.length, len = i + 3; i < len; i++) {
					var li = document.createElement('li');
					li.className = 'mui-table-view-cell';
					li.innerHTML = '<a class="mui-navigate-right">Item ' + (i + 1) + '</a>';
					//下拉刷新，新纪录插到最前面；
					table.insertBefore(li, table.firstChild);
				}
				mui('#Js-list').pullRefresh().endPulldownToRefresh(); //refresh completed
			}, 1);
		}
		var count = 0;
		/**
		 * 上拉加载具体业务实现
		 */
		function pullupRefresh() {
			setTimeout(function() {
				mui('#Js-list').pullRefresh().endPullupToRefresh((++count > 0)); //参数为true代表没有更多数据了。
				var table = document.body.querySelector('.sns-acting-cell');
				var cells = document.body.querySelectorAll('.cItem');
				for(var i = cells.length, len = i + 5; i < len; i++) {
					var li = document.createElement('li');
					li.className = 'cItem';
					li.innerHTML = '<a href="sns-detail.html" class="BL-ub BL-ub-f1">' +
						'<div class="img"><img src="images/pic/p3.jpg" /></div>' +
						'<div class="context BL-ub BL-ub-ver BL-ub-f1">' +
						'<h1 class="tit">惠州龙门大观园温泉，鲁冰花童话园2日游</h1>' +
						'<div class="date"><span class="tit-name">时间 :</span><span class="tit-text">2017-11-12</span></div>' +
						'<div class="place"><span class="tit-name">地点 :</span><span class="tit-text">广东省广州市经济技术开发区永顺大道西126号</span></div>' +
						'<div class="state"><span id="Js-isOver" class="tit-name">已结束</span><span class="tit-text"><b>40</b>人已报名</span></div></div></a>';
					table.appendChild(li);
				}
			}, 500);
		}
		
		//主列表点击事件
		mui('body').on('tap', 'a', function() {
			var href = this.getAttribute('href');
			var id = this.getAttribute("data-wid");
			//console.log(JSON.stringify(mui.currentWebview.parent()))

			//非plus环境，直接走href跳转
			if(!mui.os.plus) {
				location.href = href;
				return;
			}

			if(href && ~href.indexOf('.html')) {
				//打开新窗口
				mui.openWindow({
					url:href,
					id:id,
					show:animateObj.aniDetal
				});
			}
		});
		
		mui.plusReady(function() {
			//console.log("当前页面URL："+plus.webview.currentWebview().getURL());

		});
	</script>

</html>